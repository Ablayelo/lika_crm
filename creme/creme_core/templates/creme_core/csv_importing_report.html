{% extends "creme_core/base.html" %}
{% load i18n %}
{% load media %}
{% load creme_core_tags %}{% load creme_block %}

{% block content %}
    <table class="table_header" cellpadding="0" cellspacing="0">
        <tr>
            <td width="5%"><img src="{% media_url 'images/document_csv_64.png' %}" title="CSV" alt="CSV"/></td>
            <td width="95%">
                <h1>
                    {% trans "CSV importing : results" %}
                </h1>
            </td>
        </tr>
    </table>

    <p>
        {% with form|get_meta_value:'model'|get_meta_value:'verbose_name' as verbose_name %}
            {% blocktrans count form.imported_objects_count as counter %}{{counter}} entity with type "{{verbose_name}}" has been sucessfully imported.{% plural %}{{counter}} entities with type "{{verbose_name}}" have been sucessfully imported.{% endblocktrans %}
        {% endwith %}
    </p>

    {% with form.import_errors as errors %}
        {% if errors %}
            {% with errors|length as count %}
                <table class="table_detail_view ui-corner-all">
                    {% get_block_header colspan=2 %}
                        <th style="width: 80%;" class="collapser" align="left">{% get_block_title  '%s Erreur' '%s Erreurs' 'infos_48.png' 'Infos' count %}</th>{# TODO: i18n #}
                        <th style="width: 20%;" align="right"></th>
                    {% end_get_block_header %}
                    <tbody class="collapsable">
                        <tr>
                            <th class="block_header_line_dark">{% trans "Line of the CSV file" %}</th>
                            <th class="block_header_line_dark">{% trans "Induced error" %}</th>
                        </tr>
                        {% for error in errors %}
                            <!--{% cycle "block_line_dark" "block_line_light" as row_color %}-->
                            <tr>
                                <td class="{{row_color}}">{{error.0}}</td>
                                <td class="{{row_color}}">{{error.1}}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                    {% comment %}{% if count|gt:errors.max_size %}{% endcomment %}
                    {% if count > errors.max_size %}
                        <tfooter class="collapsable">
                            <tr>
                                <td colspan="2" class="block_header_line_dark">
                                    {% trans "Other errors have been omitted." %}
                                </td>
                            </tr>
                        </tfooter>
                    {% endif %}
                </table>
            {% endwith %}
        {% else %}
            <p>{% trans "No error when importing." %}</p>
        {% endif %}
    {% endwith %}

    <br/>
    <div>
        <ul class="button_list hbox">
            <li>
                <a class="menu_button" href="{{back_url}}">
                    <img src="{% media_url 'images/left_arrow_32.png' %}" border="0" title="{% trans "Back to the list" %}" alt="{% trans "Back to the list" %}" />
                    {% trans "Back to the list" %}
                </a>
            </li>
        </ul>
    </div>
    <br/>
{% endblock %}