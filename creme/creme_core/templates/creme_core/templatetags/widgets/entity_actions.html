{% load i18n %}
{% load media %}
<script type="text/javascript">
    $(function() {
        creme.menu.actions.flatMenu('#actions_button_{{id}}', '#actions_div_{{id}}');
    });
</script>

<span class="fg-button fg-button-icon-right ui-widget ui-corner-all ui-state-default">
    <a href="#actions_div_{{id}}" id="actions_button_{{id}}">
        {% with actions.default as action %}
            {% if action %}
                <img src="{% media_url 'images/small_down_arrow_16.png' %}"/>
                </a>|
                <a href="{{action.url}}" class="default-action">
                    {% if action.icon %}<img src="{% media_url action.icon %}" />{% endif %}
                    {{action.text}}
            {% else %}
                {% trans "Actions" %}
            {% endif %}
        {% endwith %}
    </a>
</span>
<div id="actions_div_{{id}}" style="display: none;">
    <ul>
        {% for action in actions.others %}
            <li>
                {% if action.is_allowed %}
                    <a href="{{action.url}}" {{action.attrs}}>
                        {% if action.icon %}<img src="{% media_url action.icon %}" />{% endif %}
                        {{action.text}}
                    </a>
                {% else %}
                    <span class=" forbidden">
                        {% if action.icon %}<img src="{% media_url action.icon %}" />{% endif %}
                        {{action.text}} ({% trans "forbidden" %})
                    </span>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
</div>