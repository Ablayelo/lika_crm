{% load i18n %}
{% load creme_core_tags %}
{% load report_tags %}
<div class="ui-creme-widget ui-creme-chainedselect widget-auto" widget="ui-creme-chainedselect">
    <input type="hidden" name="" class="ui-creme-input ui-creme-chainedselect"></input>
    <ul class="ui-layout hbox" style="padding:2px;">
        <li chained-name="graph" class="ui-creme-chainedselect-item">
            {% trans 'Graph' %}:
            <select auto="False" widget="ui-creme-dselect" class="ui-creme-input ui-creme-widget ui-creme-dselect"
                    style="width:10em;">
                <option value='histogram'>{% trans 'Histogram' %}</option>
                <option value='pie'>{% trans 'Pie' %}</option>
                <option value='tube'>{% trans 'Tube' %}</option>
            </select>
        </li>
        <li chained-name="sort" class="ui-creme-chainedselect-item">
            {% trans 'Sorting' %}:
            <select auto="False" widget="ui-creme-dselect" class="ui-creme-input ui-creme-widget ui-creme-dselect"
                    style="width:10em;">
                <option value="ASC">{% trans 'Ascending' %}</option>
                <option value="DESC">{% trans 'Descending' %}</option>
            </select>
        </li>
        <li class="ui-creme-chainedselect-item">
            <button onclick="$(this).parents('.ui-creme-chainedselect').creme().widget().selector('plot').creme().widget().reload();"
                    style="padding: 1px 1px;vertical-align:middle;">
                <img src="{% creme_media_url 'images/refresh_16.png' %}" alt="{% trans 'Regenerate' %}" title="{% trans 'Regenerate' %}"
                     style="border:0; vertical-align:middle;"/>
            </button>
        </li>
    </ul>
    <div chained-name="plot" class="ui-creme-chainedselect-item">
        <div class="ui-widget-content ui-creme-widget ui-creme-plotselector" widget="ui-creme-plotselector" 
             plot-data-url="/reports/graph/fetch_graph/{{report.id}}/${sort}"
             plot-name="${graph}"
             style="width:100%;">
                    <script name="histogram" type="text/json">{% report_small_barchart_json report %}</script>
                    <script name="pie" type="text/json">{% report_piechart_json report %}</script>
                    <script name="tube" type="text/json">{% report_tubechart_json report 2 %}</script>
            <div class="ui-widget-content ui-creme-widget ui-creme-jqueryplot" widget="ui-creme-jqueryplot" 
                 savable="true" style="height:300px;margin:5px 10px 5px 5px;border:0px;" format="creme.graphael.BargraphData">
            </div>
        </div>
    </div>
</div>
