{% load i18n %}
{% load creme_core_tags %}

{% if redirect %}
    <script type="text/javascript">
        {% if simple_redirect %}
            creme.utils.go_to("/reports/report/{{report_id}}/csv", false);
        {% else %}
            creme.utils.go_to("/reports/report/{{report_id}}/csv?field={{form.cleaned_data.date_fields}}&range_name={{ form.cleaned_data.date_filter.name }}{% if start %}&start={{start|to_timestamp}}{% endif %}{% if end %}&end={{end|to_timestamp}}{% endif %}", false);
        {% endif %}
    </script>
{% endif %}
<form action="" method="POST">{% csrf_token %}
    <table class="table_detail_view ui-corner-all with-header">
        <thead>
            <tr>
                <th colspan="5">{% trans 'Temporal filters' %}</th>
            </tr>
        </thead>
        <tbody>
            {% if form.non_field_errors %}
                <tr>
                    <td>{{form.non_field_errors}}</td>
                </tr>
            {% endif %}
            <tr class="header">
                <td>{{form.date_fields.label}}</td>
                <td>{{form.date_filter.label}}</td>
{#                <td>{{form.begin_date.label}}</td>#}
{#                <td>{{form.end_date.label}}</td>#}
                {% if not inner_popup %}
                    <td class="action"></td>
                {% endif %}
            </tr>
            <tr class="content">
                <td>{{form.date_fields.errors}} {{form.date_fields}}</td>
                <td>{{form.date_filter.errors}} {{form.date_filter}}</td>
{#                <td>{{form.begin_date}}</td>#}
{#                <td>{{form.end_date}}</td>#}
                {% if not inner_popup %}
                    <td class="action">
                        <button type="submit">{% trans 'Generate' %}</button>
                    </td>
                {% endif %}
            </tr>
        </tbody>
    </table>
</form>
