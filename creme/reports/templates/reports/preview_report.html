{% extends "creme_core/base.html" %}

{% load creme_core_tags %}
{% load queryset_tags %}
{% load report_tags %}

{% block page_title %} - Aperçu {{object}}{% endblock %}

{% block before_content_1 %}
    <table class="table_header" cellpadding="0" cellspacing="0">
        <tr>
            <td width="5%"><img src="{{MEDIA_URL}}images/reporting_64.png" alt=""/></td>
            <td width="70%">
                <h1>
                    Aperçu {{object|get_meta_value:"verbose_name"|title}} : {{object|title}}
                </h1>
            </td>
            <td width="25%" align="right">
                <span>
                    <a href="{{object.get_absolute_url}}">
                        <img src="{{MEDIA_URL}}images/left_arrow_64.png" title="Retour sur la fiche : '{{object}}'" alt="Retour"/>
                    </a>&nbsp;
                    <a href="/reports/report/{{object.id}}/csv">
                        <img src="{{MEDIA_URL}}images/document_csv_64.png" title="Télécharger '{{object}}' sous forme de fichier CSV" alt="Télécharger CSV"/>
                    </a>&nbsp;
                </span>
            </td>
        </tr>
    </table>
{% endblock %}


{% block content %}
    {% with object.get_children_fields_flat as flat_columns %}
        <div style="position:relative; width:100%; overflow-x: scroll;">
            <table class="table_detail_view ui-corner-all" >
                <thead>
                    <tr>
                        <th colspan="{{flat_columns|length}}">Aperçu des {{limit_to}} premières entités</th>
                    </tr>
                </thead>
                <tbody class="collapsable">
                    <tr>
                        {% comment %}
                            <!--{% for column in object.columns.all|order_by:"order" %}
                                <th class="{% cycle "block_header_line_dark" "block_header_line_light" %}">{% get_column_header column %}</th>
                            {% endfor %}-->
                        {% endcomment %}

                        {% for column in flat_columns %}
                            <th class="{% cycle "block_header_line_dark" "block_header_line_light" %}">{{column}}</th>
                        {% endfor %}
                    </tr>
                    {{html_backend.render}}
                </tbody>
            </table>
        </div>
    {% endwith %}
{% endblock %}